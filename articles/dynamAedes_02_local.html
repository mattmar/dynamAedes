<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>02. The local scale model • dynamAedes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="02. The local scale model">
<meta property="og:description" content="dynamAedes">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynamAedes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dynamAedes_01_punctual.html">01. The punctual scale model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_02_local.html">02. The local scale model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_03_regional.html">03. The Regional Scale Model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_04_uncompModel.html">04. The uncompressed model output (sub-stage level)</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_05_spreader.html">05. Temporal downscaling of entomological observations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mattmar/dynamAedes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>02. The local scale model</h1>
                        <h4 data-toc-skip class="author">Daniele Da Re,
Sophie 0. Vanwambeke, Matteo Marcantonio</h4>
            
            <h4 data-toc-skip class="date">2024-01-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mattmar/dynamAedes/blob/HEAD/vignettes/dynamAedes_02_local.Rmd" class="external-link"><code>vignettes/dynamAedes_02_local.Rmd</code></a></small>
      <div class="hidden name"><code>dynamAedes_02_local.Rmd</code></div>

    </div>

    
    
<p>This tutorial explains step-by-step the main features of
<strong>dynamAedes</strong> package, a unified modelling framework for
invasive <em>Aedes</em> mosquitoes. Users can apply the stochastic,
time-discrete and spatially-explicit population dynamical model
initially developed in <a href="https://doi.org/10.1016/j.ecoinf.2020.101180" class="external-link">Da Re et al.,
(2021)</a> for <em>Aedes aegypti</em> and then expanded for other three
species: <em>Ae. albopictus</em>, <em>Ae. japonicus</em> and <em>Ae.
koreicus</em> <a href="https://doi.org/10.1186/s13071-022-05414-4" class="external-link">Da Re
et al., (2022)</a>.</p>
<p>The model is driven by temperature, photoperiod and intra-specific
larval competition and can be applied to three different spatial scales:
punctual, local and regional. These spatial scales consider different
degrees of spatial complexity and data availability, by accounting for
both active and passive dispersal of the modelled mosquito species as
well as for the heterogeneity of input temperature data.</p>
<p>We will describe the model applications for <em>Ae. albopictus</em>
and for all spatial scales by using a simulated temperature dataset.</p>
<p>At the “local scale”, the model captures the nuances of both active
and passive mosquito dispersal. In this context, three essential
datasets are required::</p>
<ul>
<li><p><strong>Temperature Matrix</strong>: A spatially and temporally
defined numerical temperature matrix, with rows representing space and
columns signifying time, all measured in degrees Celsius.</p></li>
<li><p><strong>Coordinates Matrix</strong>: A two-column numerical
matrix detailing the coordinates for each spatial unit or cell.</p></li>
<li><p><strong>Distance Matrix</strong>: A numerical representation
highlighting the distance (in meters) between cells that are
interconnected via a road network.</p></li>
</ul>
<p>For the sake of clarity and simplicity in this tutorial, we will work
with the following simulated datasets:</p>
<ol style="list-style-type: decimal">
<li>A structured grid of 5 km lattice, each cell sized at 250 m.</li>
<li>A spatially and temporally correlated temperature time series
spanning one year.</li>
<li>A matrix that elucidates the distances between cells linked through
a conceptualized road network.</li>
</ol>
<div class="section level2">
<h2 id="input-data">1. Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<div class="section level3">
<h3 id="create-lattice-arena">1.1 Create lattice arena<a class="anchor" aria-label="anchor" href="#create-lattice-arena"></a>
</h3>
<p>Initially, we’ll establish the physical space designated for the
mosquito introduction.</p>
<p>We’ll construct a squared lattice arena with:</p>
<ul>
<li>
<strong>Dimensions</strong>: 5 km x 5 km</li>
<li>
<strong>Resolution</strong>: 250 m (which gives us 20 columns and 20
rows)</li>
<li>
<strong>Total Cells</strong>: 400</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/gstat/" class="external-link">gstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/sakoehler7/eesim" class="external-link">eesim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mattmar.github.io/dynamAedes/" class="external-link">dynamAedes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/locales.html" class="external-link">Sys.setlocale</a></span><span class="op">(</span><span class="st">"LC_TIME"</span>, <span class="st">"en_GB.UTF-8"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] ""</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gridDim</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># 5000m/250 m = 20 columns and rows</span></span>
<span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">gridDim</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">gridDim</span><span class="op">)</span></span></code></pre></div>
<p>After establishing the lattice arena, we’ll introduce a spatial
pattern to it. This pattern becomes crucial when we aim to incorporate
spatial autocorrelation (SAC) into the temperature time series later
on.</p>
<p>To achieve this spatial autocorrelation:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Semivariogram Model</strong>: We’ll employ a semivariogram
model with specified parameters:</li>
</ol>
<ul>
<li>
<strong>Sill</strong>: This is the value that the semivariogram
reaches at the defined range.</li>
<li>
<strong>Range</strong>: This represents the distance at which
spatial correlation becomes zero.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Unconditional Gaussian Simulation: Using this approach, we will
predict the semivariogram model across our lattice grid, producing the
desired spatial autocorrelated pattern.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">varioMod</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gstat/man/vgm.html" class="external-link">vgm</a></span><span class="op">(</span>psill<span class="op">=</span><span class="fl">0.005</span>, range<span class="op">=</span><span class="fl">100</span>, model<span class="op">=</span><span class="st">'Exp'</span><span class="op">)</span> <span class="co"># psill = partial sill = (sill-nugget)</span></span>
<span><span class="co"># Set up an additional variable from simple kriging</span></span>
<span><span class="va">zDummy</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gstat/man/gstat.html" class="external-link">gstat</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">z</span><span class="op">~</span><span class="fl">1</span>, </span>
<span>                locations <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>, </span>
<span>                dummy<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                beta<span class="op">=</span><span class="fl">1</span>, </span>
<span>                model<span class="op">=</span><span class="va">varioMod</span>, </span>
<span>                nmax<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Generate a randomly autocorrelated predictor data field</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">xyz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">zDummy</span>, newdata<span class="op">=</span><span class="va">xy</span>, nsim<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [using unconditional Gaussian simulation]</span></span></code></pre>
<p>Having defined our spatial pattern, we can now generate a spatially
autocorrelated raster. We’ll achieve this by incorporating the SA
variable, denoted as xyz$sim1, into the SpatRaster object.</p>
<p>It’s worth noting that such a spatially autocorrelated surface might,
for instance, depict the distribution of vegetation cover within an
urban landscape, providing valuable context and depth to our model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">utm32N</span> <span class="op">&lt;-</span> <span class="st">"+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="va">gridDim</span>, ncol<span class="op">=</span><span class="va">gridDim</span>, crs<span class="op">=</span><span class="va">utm32N</span>, ext<span class="op">=</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">1220000</span>,<span class="fl">1225000</span>, <span class="fl">5700000</span>,<span class="fl">5705000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">xyz</span><span class="op">$</span><span class="va">sim1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span>, main<span class="op">=</span><span class="st">"SAC landscape"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-4-1.png" width="95%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert to a data.frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">xyz</span><span class="op">)</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.polygons.html" class="external-link">as.polygons</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, crs<span class="op">=</span><span class="va">utm32N</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store Parameters for autocorrelation</span></span>
<span><span class="va">autocorr_factor</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate-temperature-data-with-seasonal-trend">1.2 Simulate temperature data with seasonal trend<a class="anchor" aria-label="anchor" href="#simulate-temperature-data-with-seasonal-trend"></a>
</h3>
<p>We simulate a 1-year temperature time series with seasonal trend. For
the time series we consider a mean value of 16°C and standard deviation
of 2°C.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ndays</span> <span class="op">&lt;-</span> <span class="fl">365</span><span class="op">*</span><span class="fl">1</span> <span class="co">#length of the time series in days</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sim_temp</span> <span class="op">&lt;-</span> <span class="fu">eesim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/eesim/man/create_sims.html" class="external-link">create_sims</a></span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                        n <span class="op">=</span> <span class="va">ndays</span>, </span>
<span>                        central <span class="op">=</span> <span class="fl">16</span>, </span>
<span>                        sd <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                        exposure_type <span class="op">=</span> <span class="st">"continuous"</span>, </span>
<span>                        exposure_trend <span class="op">=</span> <span class="st">"cos1"</span>, exposure_amp <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span>, </span>
<span>                        average_outcome <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                        outcome_trend <span class="op">=</span> <span class="st">"cos1"</span>,</span>
<span>                        outcome_amp <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>                        rr <span class="op">=</span> <span class="fl">1.0055</span><span class="op">)</span></span></code></pre></div>
<p>A visualisation of the distribution of temperature values and
temporal trend.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">"Temperature (°C)"</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Histogram of simulated temperatures"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-6-1.png" width="95%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">date</span>,</span>
<span>     <span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Simulated temperatures seasonal trend"</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">"Date"</span>, ylab<span class="op">=</span><span class="st">"Temperature (°C)"</span></span>
<span>     <span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-6-2.png" width="95%" style="display: block; margin: auto;"></p>
<p>Once we have our spatially autocorrelated raster, the next step is to
spatially distribute our temperature time series. We achieve this by
multiplying the time series with the autocorrelated surface we generated
in the previous step.</p>
<p>By doing so, we incorporate spatial variability into the temperature
data, ensuring that the temperature values differ across the landscape
in a manner consistent with the underlying spatial pattern (e.g.,
vegetation cover). This offers a more realistic representation of how
temperatures might vary across different areas due to various
environmental factors.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">d_t</span> <span class="op">&lt;-</span> <span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">*</span><span class="va">autocorr_factor</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">d_t</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>A comparison between the distribution of the initial temperature time
series and autocorrelated temperature surface</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">mat</span>, xlab<span class="op">=</span><span class="st">"Temperature (°C)"</span>, main<span class="op">=</span><span class="st">"Histogram of simulated spatial autocorreled temperature"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>, xlab<span class="op">=</span><span class="st">"Temperature (°C)"</span>, main<span class="op">=</span><span class="st">"Histogram of simulated temperatures"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-9-1.png" width="95%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span> </span></code></pre></div>
<div class="section level4">
<h4 id="format-temperature-data">1.2.1 Format temperature data<a class="anchor" aria-label="anchor" href="#format-temperature-data"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"d_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">ndays</span><span class="op">)</span></span>
<span><span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">mat</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="incorporating-medium-range-passive-dispersal">1.3 Incorporating Medium-Range Passive Dispersal<a class="anchor" aria-label="anchor" href="#incorporating-medium-range-passive-dispersal"></a>
</h3>
<p>In many real-world scenarios, mosquitoes do not just disperse
naturally – they often hitch rides and spread to new areas, especially
through human transportation methods. In the context of our model, this
concept is termed as “medium-range passive dispersal”.</p>
<p>To account for this mechanism of dispersal, we introduce an arbitrary
road segment into our spatial domain. This road segment will represent
pathways along which adult mosquitoes can disperse passively, most
notably through car traffic.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">roads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/sample.html" class="external-link">spatSample</a></span><span class="op">(</span><span class="va">bbox</span>, <span class="fl">5</span>, method<span class="op">=</span><span class="st">"random"</span><span class="op">)</span><span class="op">)</span>,  </span>
<span>              type<span class="op">=</span><span class="st">"lines"</span>,  </span>
<span>              crs<span class="op">=</span><span class="va">utm32N</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check simulated segment</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">roads</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-12-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>After defining the road segment we add a “buffer” of 250 m around the
road segment. Adult mosquitoes that reach or develop into cells
comprised in the 250 buffer around roads are thus able to undergo
passive dispersal.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a buffer around the converted polygon</span></span>
<span><span class="va">buff</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/buffer.html" class="external-link">buffer</a></span><span class="op">(</span><span class="va">roads</span>, width<span class="op">=</span><span class="fl">250</span><span class="op">)</span></span>
<span><span class="co"># Check grid, road segment and buffer</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">buff</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">roads</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-13-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>Next, we derive a distance matrix between cells comprised in the
spatial buffer along the road network. First, we select the cells.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">df</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs<span class="op">=</span><span class="va">utm32N</span><span class="op">)</span></span>
<span><span class="va">df_sp</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/intersect.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">df_sp</span>, <span class="va">buff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check selected cells</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">buff</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df_sp</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-14-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>Then, we compute the Euclidean distance (in meters) between each
selected cell.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/coerce.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">df_sp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modelling">2. Modelling<a class="anchor" aria-label="anchor" href="#modelling"></a>
</h2>
<div class="section level3">
<h3 id="model-settings">2.1 Model settings<a class="anchor" aria-label="anchor" href="#model-settings"></a>
</h3>
<p>Define a two-column matrix of coordinates to identify each cell in
the lattice grid.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/coerce.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">df_temp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>As for model requirement, the distance matrix must have col names
corresponding to rows in the original raster and equal to row names.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">dist_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">df_sp</span><span class="op">$</span><span class="va">id</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dist_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">dist_matrix</span><span class="op">)</span></span></code></pre></div>
<p>Moreover, distances in the distance matrix must be rounded to the
thousands.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">dist_matrix</span>,<span class="fl">2</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">1000</span>,<span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mode.html" class="external-link">storage.mode</a></span><span class="op">(</span><span class="va">dist_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"integer"</span></span>
<span></span>
<span><span class="co"># An histogram showing the distribution of distances of cells along the road network</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">dist_matrix</span>, xlab<span class="op">=</span><span class="st">"Distance (meters)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-18-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>Select a cell that intersect roads for introduction:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">icellcoords</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">dist_matrix</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">icellid</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">dist_matrix</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">buff</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df_sp</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">icellcoords</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs<span class="op">=</span><span class="va">utm32N</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"blue"</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-19-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>We are now left with a few model variables which need to be
defined.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define cells along roads into which introduce propagules on day 1</span></span>
<span><span class="va">intro.vector</span> <span class="op">&lt;-</span> <span class="va">icellid</span></span>
<span><span class="co">## Define the day of introduction (June 1st is day 1)</span></span>
<span><span class="va">str</span> <span class="op">&lt;-</span> <span class="st">"2000-07-01"</span></span>
<span><span class="co">## Define the end-day of life cycle (August 1st is the last day)</span></span>
<span><span class="va">endr</span> <span class="op">&lt;-</span> <span class="st">"2000-09-01"</span></span>
<span><span class="co">## Define the number of adult females to be introduced</span></span>
<span><span class="va">ia</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="co">## Define the number of model iterations</span></span>
<span><span class="va">it</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># The higher the number of simulations the better</span></span>
<span><span class="co">## Define the number of liters for the larval density-dependent mortality</span></span>
<span><span class="va">habitat_liters</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co">##Define average trip distance</span></span>
<span><span class="va">mypDist</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="co">## Define the number of parallel processes (for sequential iterations set nc=1)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co">## Define proj4 string</span></span>
<span><span class="va">utm32N</span> <span class="op">&lt;-</span> <span class="st">"+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"</span> </span></code></pre></div>
<p>Finally, let us prepare the temperature matrix. Float numbers in the
temperature matrix would slow the computational speed, thus we first
multiply them by 1000 and then transform them in integer numbers.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df_temp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span><span class="op">$</span><span class="va">yday</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXlt</a></span><span class="op">(</span><span class="va">endr</span><span class="op">)</span><span class="op">$</span><span class="va">yday</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-settings-and-execution">2.2 Model Settings and Execution<a class="anchor" aria-label="anchor" href="#model-settings-and-execution"></a>
</h3>
<p>In this section, we will demonstrate how to run the
<code>dynamAedes.m</code> function from the <strong>dynamAedes</strong>
package, providing the necessary settings and input data. Here a recap
of the model parameters and settings:</p>
<div class="section level4">
<h4 id="model-parameters">Model Parameters:<a class="anchor" aria-label="anchor" href="#model-parameters"></a>
</h4>
<ul>
<li>
<code>species</code>: Specifies the mosquito species to be modelled.
In this example, we’re simulating for the “albopictus” species.</li>
<li>
<code>scale</code>: Defines the spatial scale of the simulation.
Here, “lc” represents the local scale.</li>
<li>
<code>jhwv</code>: Represents the habitat in liters. In our example,
this is provided by the variable <code>habitat_liters</code>.</li>
<li>
<code>temps.matrix</code>: The temperature matrix that drives the
model. For this, we use <code>w</code>.</li>
<li>
<code>cells.coords</code>: The coordinates for each space-unit
(cell). We use <code>cc</code> for this.</li>
<li>
<code>lat</code> and <code>long</code>: Latitude and Longitude
coordinates. These are specific to our study area.</li>
<li>
<code>coords.proj4</code>: The projection of the coordinates, which
is <code>utm32N</code> in this example.</li>
<li>
<code>road.dist.matrix</code>: The distance matrix for the cells
connected through a road network.</li>
<li>
<code>avgpdisp</code>: Defines the average mosquito passive
dispersal.</li>
<li>
<code>intro.cells</code>: Cells where mosquitoes are introduced.
Specified by <code>intro.vector</code>.</li>
<li>
<code>startd</code> and <code>endd</code>: Starting and ending dates
for the simulation.</li>
<li>
<code>n.clusters</code>: Number of clusters for parallel execution,
defined by <code>cl</code>.</li>
<li>
<code>iter</code>: Number of iterations for the simulation.</li>
<li>
<code>intro.adults</code>: Number of introduced adults, provided by
<code>ia</code>.</li>
<li>
<code>compressed.output</code>: If TRUE, the output will be
compressed (no substages).</li>
<li>
<code>cellsize</code>: The size of each cell in the simulation. Set
to 250 meters here.</li>
<li>
<code>maxadisp</code>: The maximum mosquito active dispersal
distance.</li>
<li>
<code>dispbins</code>: Number of dispersal bins (discrete units of
dispersal distance).</li>
<li>
<code>seeding</code>: If TRUE, the seeding process will be executed
(for reproducibility).</li>
<li>
<code>verbose</code>: If FALSE, suppresses additional messages
during the simulation.</li>
</ul>
<p>Now, let’s execute the model:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamAedes.m.html">dynamAedes.m</a></span><span class="op">(</span>species<span class="op">=</span><span class="st">"albopictus"</span>,</span>
<span>            scale<span class="op">=</span><span class="st">"lc"</span>,  </span>
<span>            jhwv<span class="op">=</span><span class="va">habitat_liters</span>,</span>
<span>            temps.matrix<span class="op">=</span><span class="va">w</span>,</span>
<span>            cells.coords<span class="op">=</span><span class="va">cc</span>,</span>
<span>            lat<span class="op">=</span><span class="fl">50.80</span>,</span>
<span>            long<span class="op">=</span><span class="fl">4.44</span>,</span>
<span>            coords.proj4<span class="op">=</span><span class="va">utm32N</span>,</span>
<span>            road.dist.matrix<span class="op">=</span><span class="va">dist_matrix</span>,</span>
<span>            avgpdisp<span class="op">=</span><span class="va">mypDist</span>,</span>
<span>            intro.cells<span class="op">=</span><span class="va">intro.vector</span>,</span>
<span>            startd<span class="op">=</span><span class="va">str</span>,</span>
<span>            endd<span class="op">=</span><span class="va">endr</span>,</span>
<span>            n.clusters<span class="op">=</span><span class="va">cl</span>, </span>
<span>            iter<span class="op">=</span><span class="va">it</span>,</span>
<span>            intro.adults<span class="op">=</span><span class="va">ia</span>,  </span>
<span>            compressed.output<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>            cellsize<span class="op">=</span><span class="fl">250</span>,</span>
<span>            maxadisp<span class="op">=</span><span class="fl">600</span>,</span>
<span>            dispbins<span class="op">=</span><span class="fl">10</span>,</span>
<span>            seeding<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>            verbose<span class="op">=</span><span class="cn">FALSE</span></span>
<span>            <span class="op">)</span></span></code></pre></div>
<p>This simulation, with the provided settings, takes approximately 1
minute to complete. The result of the simulation will be stored in the
<code>simout</code> object.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="analyse-the-results">3. Analyse the results<a class="anchor" aria-label="anchor" href="#analyse-the-results"></a>
</h2>
<p>A first summary of simulations can be obtained with:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simout</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># Summary of dynamAedes simulations:</span></span>
<span><span class="co"># ----------------------------------</span></span>
<span><span class="co"># Species:                  Aedes albopictus </span></span>
<span><span class="co"># Scale:                    LOCAL </span></span>
<span><span class="co"># Start Date:               2000-07-01 </span></span>
<span><span class="co"># End Date:                 2000-09-01 </span></span>
<span><span class="co"># Number of Iterations:     1 </span></span>
<span><span class="co"># Introduced Stage:         adult </span></span>
<span><span class="co"># Number Introduced:        10000 </span></span>
<span><span class="co"># Is Output Compressed?:    Yes </span></span>
<span><span class="co"># Water in the System:      100 L </span></span>
<span><span class="co"># Min days with population: 61 </span></span>
<span><span class="co"># Max days with population: 61</span></span></code></pre>
<p>The <em>simout</em> object is a S4 object where simulation outputs
and related details are saved in different slot:</p>
<p>For example, the number of model iterations is saved in:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span><span class="op">@</span><span class="va">n_iterations</span></span></code></pre></div>
<p>The simulation output is stored in:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span><span class="op">@</span><span class="va">simulation</span></span></code></pre></div>
<p>Which is a list where the the <strong>first</strong> level stores
simulation of different iteration, while the
<strong>second</strong>corresponds to the simulated days in the
corresponding iteration. If we inspect the first iteration, we observe
that the model has computed <code>length(simout[[1]])</code> days, since
we have started the simulation on the 1st of July and ended on the 1st
of August.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">simout</span><span class="op">@</span><span class="va">simulation</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 61</span></span></code></pre>
<p>The <strong>third</strong> level corresponds to the quantity of
individuals for each stage (rows) in each day within each grid cell of
the landscape (columns). If we inspect the first day within the first
iteration, we obtain a matrix having:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">simout</span><span class="op">@</span><span class="va">simulation</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1]   4 400</span></span></code></pre>
<p>We can now use the auxiliary functions of the package to Analyse the
results.</p>
</div>
<div class="section level2">
<h2 id="analyse-the-results-1">3. Analyse the results<a class="anchor" aria-label="anchor" href="#analyse-the-results-1"></a>
</h2>
<div class="section level3">
<h3 id="derive-probability-of-a-successfull-introduction-at-the-end-of-the-simulated-period">3.1 Derive probability of a successfull introduction at the end of
the simulated period<a class="anchor" aria-label="anchor" href="#derive-probability-of-a-successfull-introduction-at-the-end-of-the-simulated-period"></a>
</h3>
<p>First, we can retrieve the probability of successful introduction,
computed as the proportion of model iterations that resulted in a viable
mosquito population at a given date.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psi.html">psi</a></span><span class="op">(</span><span class="va">simout</span>, eval_date <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#   Days_after_intro p_success      stage</span></span>
<span><span class="co"># 1           Day 60         1 Population</span></span></code></pre>
<p>We can also get a spatial output thanks to the function
<em>psi_sp</em>, which requires the matrix of the centroid coordinates
of pixels as only additional input.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psi.output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psi_sp.html">psi_sp</a></span><span class="op">(</span>input_sim <span class="op">=</span> <span class="va">simout</span>, eval_date <span class="op">=</span> <span class="fl">60</span>, n.clusters<span class="op">=</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>Then we can plot everything to have an overview on mosquito
population dynamics and movements given road network and average
temperature surface.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">df_temp</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"transparent"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span>, legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">buff</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df_sp</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">icellcoords</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs<span class="op">=</span><span class="va">utm32N</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">T</span>, col<span class="op">=</span><span class="st">"blue"</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span>, legend.only<span class="op">=</span><span class="cn">TRUE</span>, horizontal <span class="op">=</span> <span class="cn">TRUE</span>, legend.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text<span class="op">=</span><span class="st">'Temperature'</span>,line<span class="op">=</span><span class="op">-</span><span class="fl">3.5</span><span class="op">)</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">psi.output</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, add<span class="op">=</span><span class="cn">T</span>, legend.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text<span class="op">=</span><span class="st">'Prob colonisation'</span>, x.intersp<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-30-1.png" width="95%" style="display: block; margin: auto;">
At local scale, the interpretation of this output is more nuanced than
for the other scales: a pixel having psi=0 can be a pixel where all the
simulations resulted in an extinction or where the species has not yet
arrived through dispersal. To understand the value of the pixels may be
useful to iterate the <em>psi_sp</em> function along the vector of
simulated days.</p>
</div>
<div class="section level3">
<h3 id="derive-abundance-95-ci-for-each-life-stage-and-in-each-day">3.2 Derive abundance 95% CI for each life stage and in each day<a class="anchor" aria-label="anchor" href="#derive-abundance-95-ci-for-each-life-stage-and-in-each-day"></a>
</h3>
<p>We can now compute the interquantile range abundance of the simulated
population using the function <em>adci</em> over the whole
landscape.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">simout</span><span class="op">)</span> <span class="co">#retrieve the maximum number of simulated days</span></span>
<span></span>
<span><span class="co"># Compute the inter-quartile of abundances along the iterations</span></span>
<span><span class="va">breaks</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span><span class="op">)</span></span>
<span><span class="va">ed</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">dd</span></span>
<span></span>
<span><span class="co"># type "O" derives a non-spatial time series</span></span>
<span><span class="va">outdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="va">ed</span>, breaks<span class="op">=</span><span class="va">breaks</span>, stage<span class="op">=</span><span class="st">"Eggs"</span>, type<span class="op">=</span><span class="st">"O"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="va">ed</span>, breaks<span class="op">=</span><span class="va">breaks</span>, stage<span class="op">=</span><span class="st">"Juvenile"</span>, type<span class="op">=</span><span class="st">"O"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="va">ed</span>, breaks<span class="op">=</span><span class="va">breaks</span>, stage<span class="op">=</span><span class="st">"Adults"</span>, type<span class="op">=</span><span class="st">"O"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="va">ed</span>, breaks<span class="op">=</span><span class="va">breaks</span>, stage<span class="op">=</span><span class="st">"Dia"</span>, type<span class="op">=</span><span class="st">"O"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Then we can look at the time series of the population dynamics stage
by stage at the whole landscape level.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outdf</span><span class="op">$</span><span class="va">stage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">outdf</span><span class="op">$</span><span class="va">stage</span>, levels<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Egg'</span>, <span class="st">'DiapauseEgg'</span>, <span class="st">'Juvenile'</span>, <span class="st">'Adult'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outdf</span><span class="op">$</span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">endr</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">outdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Date</span>, y<span class="op">=</span><span class="va">X50.</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stage</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stage</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Ae. albopictus Interquantile range abundance"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">X25.</span>, ymax<span class="op">=</span><span class="va">X75.</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stage</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  col<span class="op">=</span><span class="st">"white"</span>, </span>
<span>  alpha<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>  outline.type<span class="op">=</span><span class="st">"full"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Interquantile range abundance"</span>, col<span class="op">=</span><span class="st">"Stage"</span>, fill<span class="op">=</span><span class="st">"Stage"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">stage</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.pos<span class="op">=</span><span class="st">"bottom"</span>,  </span>
<span>  text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, </span>
<span>  strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-32-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>We can also have a spatial output of quantiles of the abundance
distribution of a given life stage and for a given simulated day by
using the function <em>adci</em>. For example for eggs:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="fl">60</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span>, stage<span class="op">=</span><span class="st">"Eggs"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># LOCAL scale input simulation provided</span></span></code></pre>
<pre><code><span><span class="co"># Compressed simulation provided</span></span></code></pre>
<pre><code><span><span class="co"># Computing spatio-temporal abundance estimate.</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-33-1.png" width="95%" style="display: block; margin: auto;">
Note that if only a small number of mosquitoes are present in a pixel
over many iterations, quantiles may be 0 (especially for low quantiles)
and you may see a series of empty rasters!</p>
</div>
<div class="section level3">
<h3 id="number-of-invaded-cells">3.3 Number of invaded cells<a class="anchor" aria-label="anchor" href="#number-of-invaded-cells"></a>
</h3>
<p>Compute a summary of the number of invaded cells over model
iterations</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xcells</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/icci.html">icci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">xcells</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#    25% 50% 75% day</span></span>
<span><span class="co"># V1   2   2   2   1</span></span>
<span><span class="co"># V2   2   2   2   2</span></span>
<span><span class="co"># V3   5   5   5   3</span></span>
<span><span class="co"># V4   4   4   4   4</span></span>
<span><span class="co"># V5   4   4   4   5</span></span>
<span><span class="co"># V6   4   4   4   6</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">xcells</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#     25% 50% 75% day</span></span>
<span><span class="co"># V55  54  54  54  55</span></span>
<span><span class="co"># V56  56  56  56  56</span></span>
<span><span class="co"># V57  59  59  59  57</span></span>
<span><span class="co"># V58  60  60  60  58</span></span>
<span><span class="co"># V59  63  63  63  59</span></span>
<span><span class="co"># V60  68  68  68  60</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="estimates-of-mosquito-dispersal-spread-in-km2">3.4 Estimates of mosquito dispersal spread (in km2 )<a class="anchor" aria-label="anchor" href="#estimates-of-mosquito-dispersal-spread-in-km2"></a>
</h3>
<p>Derive estimates of mosquito dispersal (in km^2) of the simulated
mosquito populations (only when scale = “lc”) for any simulated day (in
this case for 60 days from start and end of the simulate period).</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">albo.disp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dici.html">dici</a></span><span class="op">(</span><span class="va">simout</span>, </span>
<span>               eval_date<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">60</span>,length.out<span class="op">=</span><span class="fl">60</span><span class="op">)</span>, </span>
<span>               breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span><span class="op">)</span>, </span>
<span>               space<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">`0.25`</span><span class="op">~</span><span class="va">day</span>, <span class="va">albo.disp</span>, type<span class="op">=</span><span class="st">"l"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"Population dispersal (in meters) from cell of introduction"</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">"days from introduction"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">`0.5`</span><span class="op">~</span><span class="va">day</span>, <span class="va">albo.disp</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">`0.75`</span><span class="op">~</span><span class="va">day</span>, <span class="va">albo.disp</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_02_local_files/figure-html/unnamed-chunk-35-1.png" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matteo Marcantonio, Daniele Da Re.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
