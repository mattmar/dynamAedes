<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>05. Temporal downscaling of entomological observations • dynamAedes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="05. Temporal downscaling of entomological observations">
<meta property="og:description" content="dynamAedes">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynamAedes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dynamAedes_01_punctual.html">01. The punctual scale model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_02_local.html">02. The local scale model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_03_regional.html">03. The Regional Scale Model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_04_uncompModel.html">04. The uncompressed model output (sub-stage level)</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_05_spreader.html">05. Temporal downscaling of entomological observations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mattmar/dynamAedes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>05. Temporal downscaling of entomological
observations</h1>
                        <h4 data-toc-skip class="author">Daniele Da Re,
Giovanni Marini</h4>
            
            <h4 data-toc-skip class="date">2024-01-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mattmar/dynamAedes/blob/HEAD/vignettes/dynamAedes_05_spreader.Rmd" class="external-link"><code>vignettes/dynamAedes_05_spreader.Rmd</code></a></small>
      <div class="hidden name"><code>dynamAedes_05_spreader.Rmd</code></div>

    </div>

    
    
<p>This vignette provides a comprehensive guide to the
<code>spreader</code> function available in the <code>dynamAedes</code>
package (<a href="https://doi.org/10.1186/s13071-022-05414-4" class="external-link">Da Re et
al., 2022</a>). This function performs a temporal downscaling of
observations captured by entomological traps (e.g. ovitraps, CDC-traps,
BG-sentinel) <em>spreading</em> the observed counts over the period of
activation of the traps.</p>
<p>In fact, stakeholders in charge of mosquito surveillance activities,
such as public health agencies or research centres, adopt different
monitoring schemes (i.e., size of the traps, length of the monitoring
period, length of the activation period of the trap, etc.), depending on
their needs, budget, and personnel. As a result, the monitoring schemes
are highly heterogeneous between (but also within) countries (<a href="https://doi.org/10.1371/journal.pntd.0007314" class="external-link">Jourdain et al.,
2019</a>, <a href="https://doi.org/10.46471/gigabyte.57" class="external-link">Miranda et al.,
2022</a>), restricting the temporal and spatial extent of each
monitoring effort and producing gaps in data collection.</p>
<p>To account for this heterogeneity, we adopted some rules to
standardize the different observations and coded them into the
<code>spreader</code> function. In this example, we will use a toy
dataset reproducing the outcome of the yearly monitoring activity of
<em>Aedes albopictus</em> employing ovitraps.</p>
<p>Ovitraps are cheap and efficient tools consisting of a dark container
filled with water and a substrate where mosquitoes can lay their eggs.
Ovitraps are generally inspected on a weekly or biweekly basis,
depending on the local protocol adopted by the stakeholders. We chose
the week as the fundamental temporal unit, therefore, if the monitoring
period is extended beyond one week, the <code>spreader</code> function
will distribute randomly the observed number of eggs throughout the trap
activity period using a binomial draw with a probability equal to
<em>1/n</em> weeks of activation. This means that if a trap was active
for 2 weeks and collected 500 eggs, the observed 500 eggs would be
randomly assigned to each week with a probability <em>p = 1/2</em>,
resulting in, e.g. 256 eggs collected during the 1st week and 244
collected during the second.</p>
<p>Most of the monitoring efforts span from May (week 20) to October
(week 40). Though there is some variability in the length of the
monitoring period depending on the stakeholders’ resources and local
protocols, the beginning and end of the monitoring year are often
characterized by few or no observations. To handle missing or incomplete
data and ensure consistency in analyzing the observed counts throughout
the years, we modified the observed data according to the following
assumptions:</p>
<ul>
<li><p>For November, December, January and February, if no observations
were provided, the egg count is assumed to be zero. However, if
observations were available, and the weekly number of observations was
calculated as the average of the observations for each month.</p></li>
<li><p>In March and April, if no observations were provided, the
observed count is marked as “NA,” indicating missing or unavailable
data, because under warm temperature conditions, for some mosquito
species egg hatching might already occur in March (e.g.<a href="https://doi.org/10.4081/gh.2021.996" class="external-link">Petric et al.,
2021</a>).</p></li>
</ul>
<div class="section level2">
<h2 id="surveillance-database">1. Surveillance database<a class="anchor" aria-label="anchor" href="#surveillance-database"></a>
</h2>
<p>We start with a simulated dataset of a seasonal ovitraps
monitoring.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mattmar.github.io/dynamAedes/" class="external-link">dynamAedes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/locales.html" class="external-link">Sys.setlocale</a></span><span class="op">(</span><span class="st">"LC_TIME"</span>, <span class="st">"en_GB.UTF-8"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] ""</span></span></code></pre>
<table class="table">
<colgroup>
<col width="6%">
<col width="17%">
<col width="19%">
<col width="7%">
<col width="12%">
<col width="12%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="left">year</th>
<th align="center">setting_date</th>
<th align="center">sampling_date</th>
<th align="right">value</th>
<th align="right">lifeStage</th>
<th align="left">trap_type</th>
<th align="center">species</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2014</td>
<td align="center">2014-04-21</td>
<td align="center">2014-05-12</td>
<td align="right">0</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="center">2014-05-12</td>
<td align="center">2014-06-02</td>
<td align="right">0</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="odd">
<td align="left">2014</td>
<td align="center">2014-06-02</td>
<td align="center">2014-06-30</td>
<td align="right">0</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="center">2014-06-30</td>
<td align="center">2014-07-14</td>
<td align="right">53</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="odd">
<td align="left">2014</td>
<td align="center">2014-07-14</td>
<td align="center">2014-07-28</td>
<td align="right">26</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="center">2014-07-28</td>
<td align="center">2014-08-11</td>
<td align="right">273</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="odd">
<td align="left">2014</td>
<td align="center">2014-08-11</td>
<td align="center">2014-08-25</td>
<td align="right">215</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="center">2014-08-25</td>
<td align="center">2014-09-08</td>
<td align="right">203</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="odd">
<td align="left">2014</td>
<td align="center">2014-09-08</td>
<td align="center">2014-09-22</td>
<td align="right">76</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="center">2014-09-22</td>
<td align="center">2014-10-06</td>
<td align="right">0</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="odd">
<td align="left">2014</td>
<td align="center">2014-10-06</td>
<td align="center">2014-10-20</td>
<td align="right">137</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="center">2014-10-20</td>
<td align="center">2014-11-03</td>
<td align="right">19</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
<tr class="odd">
<td align="left">2014</td>
<td align="center">2014-11-03</td>
<td align="center">2014-11-17</td>
<td align="right">0</td>
<td align="right">Eggs</td>
<td align="left">Ovitraps</td>
<td align="center">Aedes albopictus</td>
</tr>
</tbody>
</table>
<p>Where the <code>setting_date</code> represents the date when the trap
was activated and the <code>sampling_date</code> the date when the trap
was inspected and the number of eggs, displayed in the
<code>value</code> field, recorded.</p>
</div>
<div class="section level2">
<h2 id="pre-processing">2. Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h2>
<p>Now we can measure the activation period, i.e. the sampling
frequency, of the trap by counting the weeks between the installation of
the trap and the sampling.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">templatedf</span> <span class="op">&lt;-</span> <span class="va">templatedf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>delta_week<span class="op">=</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html" class="external-link">week</a></span><span class="op">(</span><span class="va">sampling_date</span><span class="op">)</span> <span class="op">-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html" class="external-link">week</a></span><span class="op">(</span><span class="va">setting_date</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">templatedf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">delta_week</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"#1A85FF"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Weeks"</span>, y<span class="op">=</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Sampling frequency"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">'none'</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, </span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span>,angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>        legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_05_spreader_files/figure-html/unnamed-chunk-4-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>To downscale the observed number of eggs on a weekly basis, we first
need to add the missing dates to the observational data.frame. This
means temporally extending the data.frame to cover the whole year.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mySeq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="st">"date"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2014-01-01'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2014-12-31'</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>temporalID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, <span class="st">"_"</span> , <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html" class="external-link">week</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 wday <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">wday</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">wday</span> <span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">temporalID</span><span class="op">)</span>  </span>
<span>  </span>
<span><span class="co">#add temporal ID to the observational dataset and merge the missing dates</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">templatedf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>temporalID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>,  <span class="st">"_"</span>,  <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_pad.html" class="external-link">str_pad</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html" class="external-link">week</a></span><span class="op">(</span><span class="va">sampling_date</span><span class="op">)</span>, <span class="fl">2</span>, pad<span class="op">=</span><span class="st">"0"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">temporalID</span>, <span class="va">value</span>, <span class="va">delta_week</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">mySeq</span>, by<span class="op">=</span><span class="st">"temporalID"</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">52</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># <span style="color: #949494;"># A tibble: 52 × 4</span></span></span>
<span><span class="co">#    temporalID value delta_week date      </span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> 2014_1        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-01-06</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> 2014_2        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-01-13</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> 2014_3        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-01-20</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> 2014_4        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-01-27</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> 2014_5        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-02-03</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> 2014_6        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-02-10</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> 2014_7        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-02-17</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> 2014_8        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-02-24</span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> 2014_9        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-03</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> 2014_10       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-10</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">11</span> 2014_11       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-17</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">12</span> 2014_12       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-24</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">13</span> 2014_13       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-31</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">14</span> 2014_14       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-04-07</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">15</span> 2014_15       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-04-14</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">16</span> 2014_16       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-04-21</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">17</span> 2014_17       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-04-28</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">18</span> 2014_18       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-05-05</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">19</span> 2014_19        0          3 2014-05-12</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">20</span> 2014_20       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-05-19</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">21</span> 2014_21       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-05-26</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">22</span> 2014_22        0          3 2014-06-02</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">23</span> 2014_23       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-06-09</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">24</span> 2014_24       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-06-16</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">25</span> 2014_25       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-06-23</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">26</span> 2014_26        0          4 2014-06-30</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">27</span> 2014_27       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-07-07</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">28</span> 2014_28       53          2 2014-07-14</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">29</span> 2014_29       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-07-21</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">30</span> 2014_30       26          2 2014-07-28</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">31</span> 2014_31       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-08-04</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">32</span> 2014_32      273          2 2014-08-11</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">33</span> 2014_33       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-08-18</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">34</span> 2014_34      215          2 2014-08-25</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">35</span> 2014_35       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-09-01</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">36</span> 2014_36      203          2 2014-09-08</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">37</span> 2014_37       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-09-15</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">38</span> 2014_38       76          2 2014-09-22</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">39</span> 2014_39       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-09-29</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">40</span> 2014_40        0          2 2014-10-06</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">41</span> 2014_41       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-10-13</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">42</span> 2014_42      137          2 2014-10-20</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">43</span> 2014_43       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-10-27</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">44</span> 2014_44       19          2 2014-11-03</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">45</span> 2014_45       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-11-10</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">46</span> 2014_46        0          2 2014-11-17</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">47</span> 2014_47       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-11-24</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">48</span> 2014_48       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-01</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">49</span> 2014_49       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-08</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">50</span> 2014_50       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-15</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">51</span> 2014_51       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-22</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">52</span> 2014_52       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-29</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="the-spreader-function">3. The <code>spreader</code> function<a class="anchor" aria-label="anchor" href="#the-spreader-function"></a>
</h2>
<div class="section level3">
<h3 id="user-defined-sampling-period">3.1 User-defined sampling period<a class="anchor" aria-label="anchor" href="#user-defined-sampling-period"></a>
</h3>
<p>We can now apply the <code>spreader</code> function, specifying the
required arguments and observing the temporal downscaling performed on
the <code>value_adj</code> field. The parameter
<code>counter.field</code> is set to consider the
<code>delta_week</code> column as a specification for the length (in
weeks) of each sampling.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># apply spreader function</span></span>
<span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spreader.html">spreader</a></span><span class="op">(</span>mydf <span class="op">=</span> <span class="va">tmp</span>, </span>
<span>         date.field <span class="op">=</span> <span class="st">"date"</span>, </span>
<span>         value.field <span class="op">=</span> <span class="st">"value"</span>, </span>
<span>         counter.field <span class="op">=</span> <span class="st">"delta_week"</span>,</span>
<span>         seed<span class="op">=</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">52</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># <span style="color: #949494;"># A tibble: 52 × 5</span></span></span>
<span><span class="co">#    temporalID value delta_week date       value_adj</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 1</span> 2014_1        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-01-06      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 2</span> 2014_2        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-01-13      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 3</span> 2014_3        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-01-20      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 4</span> 2014_4        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-01-27      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 5</span> 2014_5        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-02-03      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 6</span> 2014_6        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-02-10      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 7</span> 2014_7        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-02-17      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 8</span> 2014_8        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-02-24      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;"> 9</span> 2014_9        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-03     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">10</span> 2014_10       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-10     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">11</span> 2014_11       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-17     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">12</span> 2014_12       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-24     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">13</span> 2014_13       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-03-31     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">14</span> 2014_14       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-04-07     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">15</span> 2014_15       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-04-14     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">16</span> 2014_16       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-04-21     <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">17</span> 2014_17       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-04-28      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">18</span> 2014_18       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-05-05      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">19</span> 2014_19        0          3 2014-05-12      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">20</span> 2014_20       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-05-19      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">21</span> 2014_21       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-05-26      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">22</span> 2014_22        0          3 2014-06-02      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">23</span> 2014_23       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-06-09      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">24</span> 2014_24       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-06-16      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">25</span> 2014_25       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-06-23      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">26</span> 2014_26        0          4 2014-06-30      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">27</span> 2014_27       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-07-07     24   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">28</span> 2014_28       53          2 2014-07-14     29   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">29</span> 2014_29       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-07-21     15   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">30</span> 2014_30       26          2 2014-07-28     11   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">31</span> 2014_31       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-08-04    134   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">32</span> 2014_32      273          2 2014-08-11    139   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">33</span> 2014_33       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-08-18    109   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">34</span> 2014_34      215          2 2014-08-25    106   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">35</span> 2014_35       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-09-01    109   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">36</span> 2014_36      203          2 2014-09-08     94   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">37</span> 2014_37       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-09-15     33   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">38</span> 2014_38       76          2 2014-09-22     43   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">39</span> 2014_39       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-09-29      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">40</span> 2014_40        0          2 2014-10-06      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">41</span> 2014_41       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-10-13     74   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">42</span> 2014_42      137          2 2014-10-20     63   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">43</span> 2014_43       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-10-27      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">44</span> 2014_44       19          2 2014-11-03      4.75</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">45</span> 2014_45       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-11-10      4.75</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">46</span> 2014_46        0          2 2014-11-17      4.75</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">47</span> 2014_47       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-11-24      4.75</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">48</span> 2014_48       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-01      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">49</span> 2014_49       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-08      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">50</span> 2014_50       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-15      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">51</span> 2014_51       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-22      0   </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">52</span> 2014_52       <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span> 2014-12-29      0</span></span></code></pre>
<p>To visualize the effect of the temporal downscaling:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Observed"</span> <span class="op">=</span> <span class="st">"#E1BE6A"</span>, <span class="st">"Post-processed"</span> <span class="op">=</span> <span class="st">"#40B0A6"</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">templatedf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html" class="external-link">week</a></span><span class="op">(</span><span class="va">sampling_date</span><span class="op">)</span>, </span>
<span>         field <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">week</span>, <span class="va">value</span>, <span class="va">field</span><span class="op">)</span>, </span>
<span>  <span class="va">ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html" class="external-link">week</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, </span>
<span>         field <span class="op">=</span> <span class="st">"Post-processed"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">week</span>, <span class="va">value_adj</span>, <span class="va">field</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>   </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>  value <span class="op">=</span> <span class="va">value_adj</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">week</span>, <span class="va">value</span>,  col<span class="op">=</span><span class="va">field</span>, fill<span class="op">=</span><span class="va">field</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span>, stat<span class="op">=</span><span class="st">"identity"</span>, size<span class="op">=</span><span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cols</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cols</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">field</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Week"</span>, y<span class="op">=</span><span class="st">"Egg abundance"</span> <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span> breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">50</span>, by <span class="op">=</span><span class="fl">5</span><span class="op">)</span>, limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">52</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.background<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">'none'</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, </span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span>,angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>        legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_05_spreader_files/figure-html/unnamed-chunk-7-1.png" width="95%" style="display: block; margin: auto;"></p>
<p>Firstly, we can note that the new observations consist of zeros for
weeks 1-8 (January and February). From March up to mid-April
<code>value_adj = NA</code> as no actual data was recorded. Sampling
started on week 17 and the trap was collected 2 weeks later (week 19)
with no eggs collected (value=0). Thus <code>value_adj = 0</code> for
the three considered weeks. The first observation different from 0
occurred on week 28 when 53 eggs were collected over two weeks. Thus the
observation was spread on weeks 27 and 28 with <code>value_adj</code>
equal to 24 and 29 respectively (24+29 = 53).</p>
<p>We remark that observations are reallocated randomly; the spreader
function allows us to specify the seed in the arguments, so it is
possible to recreate the same new dataset using the same seed.</p>
<p>Finally, the monitoring activity ended on week 46 (mid-November), so
we averaged those samplings and spread them over the month. As no data
was recorded in December, <code>value_adj</code> is set equal to
zero.</p>
</div>
<div class="section level3">
<h3 id="automatic-detection-of-the-sampling-period">3.2 Automatic detection of the sampling period<a class="anchor" aria-label="anchor" href="#automatic-detection-of-the-sampling-period"></a>
</h3>
<p>In this section we apply the <code>spreader</code> function with no
specification for the <code>counter.field</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># apply spreader function</span></span>
<span><span class="va">ex_noSampl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spreader.html">spreader</a></span><span class="op">(</span>mydf <span class="op">=</span> <span class="va">tmp</span>, </span>
<span>         date.field <span class="op">=</span> <span class="st">"date"</span>, </span>
<span>         value.field <span class="op">=</span> <span class="st">"value"</span>, </span>
<span>         counter.field <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>         seed<span class="op">=</span><span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<p>The output is the same as the one obtained previously since we used
the same seed value. This is even more clear from the following
plot:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ex</span><span class="op">$</span><span class="va">value_adj</span>, <span class="va">ex_noSampl</span><span class="op">$</span><span class="va">value_adj</span>, </span>
<span>     xlab <span class="op">=</span><span class="st">"User-defined counter.field"</span>, </span>
<span>     ylab <span class="op">=</span><span class="st">"Automatic counter.field"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">1</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_05_spreader_files/figure-html/unnamed-chunk-9-1.png" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="usage-notes">4. Usage notes<a class="anchor" aria-label="anchor" href="#usage-notes"></a>
</h2>
<p>In this example, the <em>week</em> was defined as the fundamental
temporal unit. However, the function can be applied with the same
rationale to other temporal units, i.e. <em>days</em>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matteo Marcantonio, Daniele Da Re.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
