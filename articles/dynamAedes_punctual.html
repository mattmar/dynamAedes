<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dynamAedes">
<title>Describing the main features of *dynamAedes*: the punctual scale model. • dynamAedes</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Describing the main features of *dynamAedes*: the punctual scale model.">
<meta property="og:description" content="dynamAedes">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dynamAedes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dynamAedes_local.html">Describing the main features of *dynamAedes*: the local scale model.</a>
    <a class="dropdown-item" href="../articles/dynamAedes_punctual.html">Describing the main features of *dynamAedes*: the punctual scale model.</a>
    <a class="dropdown-item" href="../articles/dynamAedes_regional.html">Describing the main features of *dynamAedes*: the regional scale model.</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mattmar/dynamAedes/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Describing the main features of *dynamAedes*: the punctual scale model.</h1>
            <h3 data-toc-skip class="subtitle">dynamAedes: A Unified Mechanistic Model For The Population Dynamics Of Invasive <em>Aedes</em> Mosquitoes.</h3>
                        <h4 data-toc-skip class="author">Daniele Da Re, Sophie 0. Vanwambeke, Matteo Marcantonio</h4>
            
            <h4 data-toc-skip class="date">2022-06-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mattmar/dynamAedes/blob/HEAD/vignettes/dynamAedes_punctual.Rmd" class="external-link"><code>vignettes/dynamAedes_punctual.Rmd</code></a></small>
      <div class="d-none name"><code>dynamAedes_punctual.Rmd</code></div>
    </div>

    
    
<p>This tutorial explains step-by-step the main features of <strong>dynamAedes</strong> package, a unified modelling framework for invasive <em>Aedes</em> mosquitoes. Users can apply the stochastic, time-discrete and spatially-explicit population dynamical model initially developed in <a href="https://doi.org/10.1016/j.ecoinf.2020.101180" class="external-link">Da Re et al., (2021)</a> for <em>Aedes aegypti</em> and then expanded for other three species: <em>Ae. albopictus</em>, <em>Ae. japonicus</em> and <em>Ae. koreicus</em> <a href="http://dx.doi.org/10.1101/2021.12.21.473628" class="external-link">Da Re et al., (<em>under review</em>)</a>.</p>
<p>The model is driven by temperature, photoperiod and intra-specific larval competition and can be applied to three different spatial scales: punctual, local and regional. These spatial scales consider different degrees of spatial complexity and data availability, by accounting for both active and passive dispersal of the modelled mosquito species as well as for the heterogeneity of input temperature data.</p>
<p>We will describe the model applications for <em>Ae. albopictus</em> and for all spatial scales by using a simulated temperature dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://spatstat.org/" class="external-link">spatstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/gstat/" class="external-link">gstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://github.com/sakoehler7/eesim" class="external-link">eesim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">geosphere</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/rgeos/" class="external-link">rgeos</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://rgdal.r-forge.r-project.org" class="external-link">rgdal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://mattmar.github.io/dynamAedes/">dynamAedes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/locales.html" class="external-link">Sys.setlocale</a></span><span class="op">(</span><span class="st">"LC_TIME"</span>, <span class="st">"en_GB.UTF-8"</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co"># [1] ""</span></span></code></pre>
<div class="section level2">
<h2 id="punctual-scale-model">Punctual scale model<a class="anchor" aria-label="anchor" href="#punctual-scale-model"></a>
</h2>
<p>At punctual scale, the model only requires a weather station temperature time series provided as a numerical matrix (in degree Celsius). For the purpose of this tutorial, we simulate a 1-year long temperature time series.</p>
<div class="section level3">
<h3 id="simulate-temperature-data-with-seasonal-trend">Simulate temperature data with seasonal trend<a class="anchor" aria-label="anchor" href="#simulate-temperature-data-with-seasonal-trend"></a>
</h3>
<p>We first simulate a 1-year temperature time series with seasonal trend. For the time series we consider a mean value of 16°C and standard deviation of 2°C.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ndays</span> <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">1</span> <span class="co">#length of the time series in days</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sim_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/eesim/man/create_sims.html" class="external-link">create_sims</a></span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                        n <span class="op">=</span> <span class="va">ndays</span>, </span>
<span>                        central <span class="op">=</span> <span class="fl">16</span>, </span>
<span>                        sd <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                        exposure_type <span class="op">=</span> <span class="st">"continuous"</span>, </span>
<span>                        exposure_trend <span class="op">=</span> <span class="st">"cos1"</span>, exposure_amp <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span>, </span>
<span>                        average_outcome <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                        outcome_trend <span class="op">=</span> <span class="st">"cos1"</span>,</span>
<span>                        outcome_amp <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>                        rr <span class="op">=</span> <span class="fl">1.0055</span><span class="op">)</span></span></code></pre></div>
<p>A visualisation of the distribution of temperature values and temporal trend.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">"Temperature (°C)"</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Histogram of simulated temperatures"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_punctual_files/figure-html/unnamed-chunk-3-1.png" width="95%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">date</span>,</span>
<span>     <span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Simulated temperatures seasonal trend"</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">"Date"</span>, ylab<span class="op">=</span><span class="st">"Temperature (°C)"</span></span>
<span>     <span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_punctual_files/figure-html/unnamed-chunk-3-2.png" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="format-the-simulated-input-datasets-and-run-the-model">Format the simulated input datasets and run the model<a class="anchor" aria-label="anchor" href="#format-the-simulated-input-datasets-and-run-the-model"></a>
</h3>
<div class="section level4">
<h4 id="model-settings">Model settings<a class="anchor" aria-label="anchor" href="#model-settings"></a>
</h4>
<p>Float numbers in the temperature matrix would slow the computational speed, they must be multiplied by 1000 and then transformed in integer numbers. We also transpose the matrix from long to wide format, since we conceptualized the model structure considering the rows as the spatial component (e.g., observations; here = 1) and the columns as the temporal one (e.g., variables).</p>
<p>We are now left with a few model parameters which need to be defined by the user.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define the day of introduction (July 1st is day 1)</span></span>
<span><span class="va">str</span> <span class="op">=</span> <span class="st">"2000-07-01"</span></span>
<span><span class="co">## Define the end-day of life cycle (August 1st is the last day)</span></span>
<span><span class="va">endr</span> <span class="op">=</span> <span class="st">"2000-08-01"</span></span>
<span><span class="co">## Define the number of eggs to be introduced</span></span>
<span><span class="va">ie</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="co">## Define the number of model iterations</span></span>
<span><span class="va">it</span> <span class="op">=</span> <span class="fl">1</span> <span class="co"># The higher the number of simulations the better</span></span>
<span><span class="co">## Define the number of liters for the larval density-dependent mortality</span></span>
<span><span class="va">habitat_liters</span><span class="op">=</span><span class="fl">1</span></span>
<span><span class="co">#Define latitude and longitude for the diapause process</span></span>
<span><span class="va">myLat</span><span class="op">=</span><span class="fl">42</span></span>
<span><span class="va">myLon</span><span class="op">=</span><span class="fl">7</span></span>
<span><span class="co">## Define the number of parallel processes (for sequential itarations set nc=1)</span></span>
<span><span class="va">cl</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="co">## Set output name for the *.RDS output will be saved</span></span>
<span><span class="co">#outname= paste0("dynamAedes_albo_ws_dayintro_",str,"_end",endr,"_niters",it,"_neggs",ie)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Date"</span> <span class="op">=</span> <span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">date</span>, <span class="st">"temp"</span> <span class="op">=</span> <span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">df_temp</span><span class="op">$</span><span class="va">temp</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,<span class="st">"%j"</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">endr</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,<span class="st">"%j"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="run-the-model">Run the model<a class="anchor" aria-label="anchor" href="#run-the-model"></a>
</h4>
<p>Running the model with the settings specified in this example takes about 2 minutes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamAedes.html">dynamAedes</a></span><span class="op">(</span>species<span class="op">=</span><span class="st">"albopictus"</span>, </span>
<span>                     scale<span class="op">=</span><span class="st">"ws"</span>,  </span>
<span>                     ihwv<span class="op">=</span><span class="va">habitat_liters</span>,  </span>
<span>                     temps.matrix<span class="op">=</span><span class="va">w</span>,  </span>
<span>                     startd<span class="op">=</span><span class="va">str</span>, </span>
<span>                     endd<span class="op">=</span><span class="va">endr</span>,  </span>
<span>                     n.clusters<span class="op">=</span><span class="va">cl</span>, </span>
<span>                     iter<span class="op">=</span><span class="va">it</span>,  </span>
<span>                     intro.eggs<span class="op">=</span><span class="va">ie</span>,  </span>
<span>                     compressed.output<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                     lat<span class="op">=</span><span class="va">myLat</span>, </span>
<span>                     long<span class="op">=</span><span class="va">myLon</span>,</span>
<span>                     verbose<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                     seeding<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code># 
  |                                                                            
  |                                                                      |   0%</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="analyse-the-results">Analyse the results<a class="anchor" aria-label="anchor" href="#analyse-the-results"></a>
</h3>
<p>We first explore the model output structure: the <em>simout</em> object is a nested list.</p>
<p>The <strong>first</strong> level corresponds to the number of model iterations</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">it</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 1</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">simout</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 1</span></span></code></pre>
<p>The <strong>second</strong> level corresponds to the simulated days. So if we inspect the first iteration, we observe that the model has computed <code>rlength(simout[[1]])</code> days, since we have started the simulation on the 1st of July and ended on the 1st of August.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">simout</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 30</span></span></code></pre>
<p>The <strong>third</strong> level corresponds to the amount of individuals for each stage (rows). So if we inspect the 1st and the 15th day within the first iteration, we obtain a matrix having</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">simout</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 4 1</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg           645</span></span>
<span><span class="co"># juvenile      355</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">15</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg           128</span></span>
<span><span class="co"># juvenile      108</span></span>
<span><span class="co"># adult           8</span></span>
<span><span class="co"># diapause_egg    0</span></span></code></pre>
<p>We can now use the auxiliary functions of the package to analyse the results.</p>
<div class="section level4">
<h4 id="derive-probability-of-a-successfull-introduction-at-the-end-of-the-simulated-period">Derive probability of a successfull introduction at the end of the simulated period<a class="anchor" aria-label="anchor" href="#derive-probability-of-a-successfull-introduction-at-the-end-of-the-simulated-period"></a>
</h4>
<p>First, we can retrieve the “probability of successful introduction”, computed as the proportion of model iterations that resulted in a viable mosquito population at a given date. In this case the results is 1, since we have only one iteration and the population is still viable at the end of the simulation.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psi.html">psi</a></span><span class="op">(</span>input_sim <span class="op">=</span> <span class="va">simout</span>, eval_date <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#   Days_after_intro p_success      stage</span></span>
<span><span class="co"># 1           Day 30         1 Population</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="derive-abundance-95-ci-for-each-life-stage-and-in-each-day">Derive abundance 95% CI for each life stage and in each day<a class="anchor" aria-label="anchor" href="#derive-abundance-95-ci-for-each-life-stage-and-in-each-day"></a>
</h4>
<p>We now compute the interquantile range abundance for all the stages of the simulated population using the function <em>adci</em>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve the maximum number of simulated days</span></span>
<span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">simout</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute the abundance</span></span>
<span><span class="va">outdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">dd</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span><span class="op">)</span>, st<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                    myStage <span class="op">=</span> <span class="st">'Egg'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>                    <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">dd</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span><span class="op">)</span>, st<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, </span>
<span>                    myStage<span class="op">=</span><span class="st">'Juvenile'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>                    <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">dd</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span><span class="op">)</span>, st<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>                    myStage<span class="op">=</span><span class="st">'Adult'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>                    <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">dd</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span><span class="op">)</span>, st<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, </span>
<span>                    myStage<span class="op">=</span><span class="st">'Diapausing egg'</span><span class="op">)</span><span class="op">)</span></span>
<span>               <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">outdf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>myStage<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">myStage</span>, levels<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Egg'</span>, <span class="st">'Diapausing egg'</span>, <span class="st">'Juvenile'</span>, <span class="st">'Adult'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         X25.<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">X25.</span><span class="op">)</span>, </span>
<span>         X50.<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">X50.</span><span class="op">)</span>,</span>
<span>         X75.<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">X75.</span><span class="op">)</span>, </span>
<span>         Date<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">endr</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span>, by<span class="op">=</span><span class="st">"day"</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Date</span>, y<span class="op">=</span><span class="va">X50.</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">myStage</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">myStage</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Ae. albopictus Interquantile range abundance"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">X25.</span>,ymax<span class="op">=</span><span class="va">X75.</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">myStage</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              col<span class="op">=</span><span class="st">"white"</span>,</span>
<span>              alpha<span class="op">=</span><span class="fl">0.2</span>,</span>
<span>              outline.type<span class="op">=</span><span class="st">"full"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Interquantile range abundance"</span>, col<span class="op">=</span><span class="st">"Stage"</span>, fill<span class="op">=</span><span class="st">"Stage"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">myStage</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.pos<span class="op">=</span><span class="st">"bottom"</span>,  </span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span> , </span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_punctual_files/figure-html/unnamed-chunk-11-1.png" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matteo Marcantonio, Daniele Da Re.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
