<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>04. The uncompressed model output (sub-stage level) • dynamAedes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="04. The uncompressed model output (sub-stage level)">
<meta property="og:description" content="dynamAedes">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynamAedes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dynamAedes_01_punctual.html">01. The punctual scale model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_02_local.html">02. The local scale model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_03_regional.html">03. The Regional Scale Model</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_04_uncompModel.html">04. The uncompressed model output (sub-stage level)</a>
    </li>
    <li>
      <a href="../articles/dynamAedes_05_spreader.html">05. Temporal downscaling of entomological observations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mattmar/dynamAedes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>04. The uncompressed model output (sub-stage
level)</h1>
                        <h4 data-toc-skip class="author">Daniele Da Re,
Matteo Marcantonio</h4>
            
            <h4 data-toc-skip class="date">2024-01-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mattmar/dynamAedes/blob/HEAD/vignettes/dynamAedes_04_uncompModel.Rmd" class="external-link"><code>vignettes/dynamAedes_04_uncompModel.Rmd</code></a></small>
      <div class="hidden name"><code>dynamAedes_04_uncompModel.Rmd</code></div>

    </div>

    
    
<p>This tutorial explains step-by-step the main features of
<strong>dynamAedes</strong> package, a unified modelling framework for
invasive <em>Aedes</em> mosquitoes. Users can apply the stochastic,
time-discrete and spatially-explicit population dynamical model
initially developed in <a href="https://doi.org/10.1016/j.ecoinf.2020.101180" class="external-link">Da Re et al.,
(2021)</a> for <em>Aedes aegypti</em> and then expanded for other three
species: <em>Ae. albopictus</em>, <em>Ae. japonicus</em> and <em>Ae.
koreicus</em> <a href="https://doi.org/10.1186/s13071-022-05414-4" class="external-link">Da Re
et al., (2022)</a>.</p>
<p>The model is driven by temperature, photoperiod and intra-specific
larval competition and can be applied to three different spatial scales:
punctual, local and regional. These spatial scales consider different
degrees of spatial complexity and data availability, by accounting for
both active and passive dispersal of the modelled mosquito species as
well as for the heterogeneity of input temperature data.</p>
<p>We will describe the <em>uncompressed</em> model application for
<em>Ae. albopictus</em> at the punctual and regional scales by using a
simulated temperature dataset. The <em>uncompressed</em> model return
the number of simulated individuals not only for the three main
compartments, i.e. life stages (eggs, juveniles and adults), but also
the number of simulated individuals within each sub-compartments, such
as 2-days old eggs or host-seeking adult females.</p>
<div class="section level2">
<h2 id="sub-compartment-structure">1. Sub-compartment structure<a class="anchor" aria-label="anchor" href="#sub-compartment-structure"></a>
</h2>
<p>The general structure of the compartments and sub-compartments for
the four species can be inspected from the
<code>AedeslifeHistoryList</code> object available in the package.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="19%">
<col width="17%">
<col width="20%">
<col width="20%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="center">Eggs</th>
<th align="center">Juveniles</th>
<th align="center">Adults</th>
<th align="center">DiapauseEggs</th>
<th align="center">SubCompartments</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">new layed egg</td>
<td align="center">1 day juv</td>
<td align="center">blood fed</td>
<td align="center">new layed degg</td>
<td align="center">SC-1</td>
</tr>
<tr class="even">
<td align="center">2 day egg</td>
<td align="center">2 day juv</td>
<td align="center">ovipositing d1</td>
<td align="center">2 day degg</td>
<td align="center">SC-2</td>
</tr>
<tr class="odd">
<td align="center">3 day egg</td>
<td align="center">3 day juv</td>
<td align="center">ovipositing d2</td>
<td align="center">3 day degg</td>
<td align="center">SC-3</td>
</tr>
<tr class="even">
<td align="center">4 day egg</td>
<td align="center">4 day juv</td>
<td align="center">Host-seeking</td>
<td align="center">4 day degg</td>
<td align="center">SC-4</td>
</tr>
<tr class="odd">
<td align="center">5 day egg</td>
<td align="center">5 day juv</td>
<td align="center">new emerged</td>
<td align="center">5 day degg</td>
<td align="center">SC-5</td>
</tr>
<tr class="even">
<td align="center">6 day egg</td>
<td align="center">6 day juv</td>
<td align="center">NA</td>
<td align="center">6 day degg</td>
<td align="center">SC-6</td>
</tr>
<tr class="odd">
<td align="center">7 day egg</td>
<td align="center">7 day juv</td>
<td align="center">NA</td>
<td align="center">7 day degg</td>
<td align="center">SC-7</td>
</tr>
<tr class="even">
<td align="center">&gt;=8 day egg</td>
<td align="center">8 day juv</td>
<td align="center">NA</td>
<td align="center">&gt;=8 day degg</td>
<td align="center">SC-8</td>
</tr>
<tr class="odd">
<td align="center">NA</td>
<td align="center">9 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">SC-9</td>
</tr>
<tr class="even">
<td align="center">NA</td>
<td align="center">10 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">SC-10</td>
</tr>
<tr class="odd">
<td align="center">NA</td>
<td align="center">11 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">SC-11</td>
</tr>
<tr class="even">
<td align="center">NA</td>
<td align="center">&gt;=12 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">SC-12</td>
</tr>
</tbody>
</table>
<p>For each species, the sub-compartments are arranges as follows.</p>
<div class="section level3">
<h3 id="aedes-aegypti">1.1 <em>Aedes aegypti</em><a class="anchor" aria-label="anchor" href="#aedes-aegypti"></a>
</h3>
<table class="table">
<colgroup>
<col width="18%">
<col width="24%">
<col width="18%">
<col width="17%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="center">Species</th>
<th align="center">Sub.compartments</th>
<th align="center">Eggs</th>
<th align="center">Juveniles</th>
<th align="center">Adults</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><em>Ae. aegypti</em></td>
<td align="center">Sub-compartment 1</td>
<td align="center">New layed egg</td>
<td align="center">1 day juv</td>
<td align="center">blood fed</td>
</tr>
<tr class="even">
<td align="center"><em>Ae. aegypti</em></td>
<td align="center">Sub-compartment 2</td>
<td align="center">2 day egg</td>
<td align="center">2 day juv</td>
<td align="center">ovipositing d1</td>
</tr>
<tr class="odd">
<td align="center"><em>Ae. aegypti</em></td>
<td align="center">Sub-compartment 3</td>
<td align="center">3 day egg</td>
<td align="center">3 day juv</td>
<td align="center">ovipositing d2</td>
</tr>
<tr class="even">
<td align="center"><em>Ae. aegypti</em></td>
<td align="center">Sub-compartment 4</td>
<td align="center">&gt;= 4 day egg</td>
<td align="center">4 day juv</td>
<td align="center">Host-seeking</td>
</tr>
<tr class="odd">
<td align="center"><em>Ae. aegypti</em></td>
<td align="center">Sub-compartment 5</td>
<td align="center">NA</td>
<td align="center">5 day juv</td>
<td align="center">new emerged</td>
</tr>
<tr class="even">
<td align="center"><em>Ae. aegypti</em></td>
<td align="center">Sub-compartment 6</td>
<td align="center">NA</td>
<td align="center">&gt;= 6 day juv</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="aedes-albopictus">1.2 <em>Aedes albopictus</em><a class="anchor" aria-label="anchor" href="#aedes-albopictus"></a>
</h3>
<table class="table">
<colgroup>
<col width="18%">
<col width="19%">
<col width="15%">
<col width="14%">
<col width="16%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="center">Species</th>
<th align="center">Sub.compartments</th>
<th align="center">Eggs</th>
<th align="center">Juveniles</th>
<th align="center">Adults</th>
<th align="center">Diapausing.Eggs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><em>Ae. albopictus</em></td>
<td align="center">Sub-compartment 1</td>
<td align="center">New layed egg</td>
<td align="center">1 day juv</td>
<td align="center">blood fed</td>
<td align="center">New layed degg</td>
</tr>
<tr class="even">
<td align="center"><em>Ae. albopictus</em></td>
<td align="center">Sub-compartment 2</td>
<td align="center">2 day egg</td>
<td align="center">2 day juv</td>
<td align="center">ovipositing d1</td>
<td align="center">2 day degg</td>
</tr>
<tr class="odd">
<td align="center"><em>Ae. albopictus</em></td>
<td align="center">Sub-compartment 3</td>
<td align="center">3 day egg</td>
<td align="center">3 day juv</td>
<td align="center">ovipositing d2</td>
<td align="center">3 day degg</td>
</tr>
<tr class="even">
<td align="center"><em>Ae. albopictus</em></td>
<td align="center">Sub-compartment 4</td>
<td align="center">&gt;= 4 day egg</td>
<td align="center">4 day juv</td>
<td align="center">Host-seeking</td>
<td align="center">&gt;= 4 day degg</td>
</tr>
<tr class="odd">
<td align="center"><em>Ae. albopictus</em></td>
<td align="center">Sub-compartment 5</td>
<td align="center">NA</td>
<td align="center">5 day juv</td>
<td align="center">new emerged</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><em>Ae. albopictus</em></td>
<td align="center">Sub-compartment 6</td>
<td align="center">NA</td>
<td align="center">&gt;= 6 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="aedes-japonicus-and-ae--koreicus">1.3 <em>Aedes japonicus</em> and <em>Ae. koreicus</em><a class="anchor" aria-label="anchor" href="#aedes-japonicus-and-ae--koreicus"></a>
</h3>
<table class="table">
<colgroup>
<col width="29%">
<col width="17%">
<col width="12%">
<col width="11%">
<col width="13%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="center">Species</th>
<th align="center">Sub.compartments</th>
<th align="center">Eggs</th>
<th align="center">Juveniles</th>
<th align="center">Adults</th>
<th align="center">Diapausing.Eggs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 1</td>
<td align="center">New layed egg</td>
<td align="center">1 day juv</td>
<td align="center">blood fed</td>
<td align="center">New layed degg</td>
</tr>
<tr class="even">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 2</td>
<td align="center">2 day egg</td>
<td align="center">2 day juv</td>
<td align="center">ovipositing d1</td>
<td align="center">2 day degg</td>
</tr>
<tr class="odd">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 3</td>
<td align="center">3 day egg</td>
<td align="center">3 day juv</td>
<td align="center">ovipositing d2</td>
<td align="center">3 day degg</td>
</tr>
<tr class="even">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 4</td>
<td align="center">4 day egg</td>
<td align="center">4 day juv</td>
<td align="center">Host-seeking</td>
<td align="center">4 day degg</td>
</tr>
<tr class="odd">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 5</td>
<td align="center">5 day egg</td>
<td align="center">5 day juv</td>
<td align="center">new emerged</td>
<td align="center">5 day degg</td>
</tr>
<tr class="even">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 6</td>
<td align="center">6 day egg</td>
<td align="center">6 day juv</td>
<td align="center">NA</td>
<td align="center">6 day degg</td>
</tr>
<tr class="odd">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 7</td>
<td align="center">7 day egg</td>
<td align="center">7 day juv</td>
<td align="center">NA</td>
<td align="center">7 day degg</td>
</tr>
<tr class="even">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 8</td>
<td align="center">&gt;=8 day egg</td>
<td align="center">8 day juv</td>
<td align="center">NA</td>
<td align="center">&gt;=8 day degg</td>
</tr>
<tr class="odd">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 9</td>
<td align="center">NA</td>
<td align="center">9 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 10</td>
<td align="center">NA</td>
<td align="center">10 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 11</td>
<td align="center">NA</td>
<td align="center">11 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">
<em>Ae. japonicus</em> or <em>Ae. koreicus</em>
</td>
<td align="center">Sub-compartment 12</td>
<td align="center">NA</td>
<td align="center">&gt;=12 day juv</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="punctual-scale-model">2. Punctual scale model<a class="anchor" aria-label="anchor" href="#punctual-scale-model"></a>
</h2>
<div class="section level3">
<h3 id="input-data-and-model-settings">2.1 Input data and model settings<a class="anchor" aria-label="anchor" href="#input-data-and-model-settings"></a>
</h3>
<p>At the punctual scale, the model only requires a temperature time
series, recorded by e.g. a weather station, provided as a numerical
matrix (in degree Celsius). For the purpose of this tutorial, we
simulate a 1-year long temperature time series and, for the sake of
brevity, we will not discuss the chunks of code already presented in
other tutorials.</p>
<pre><code><span><span class="co"># [1] ""</span></span></code></pre>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ndays</span> <span class="op">&lt;-</span> <span class="fl">365</span><span class="op">*</span><span class="fl">1</span> <span class="co">#length of the time series in days</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sim_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/eesim/man/create_sims.html" class="external-link">create_sims</a></span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  n <span class="op">=</span> <span class="va">ndays</span>, </span>
<span>  central <span class="op">=</span> <span class="fl">16</span>, </span>
<span>  sd <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  exposure_type <span class="op">=</span> <span class="st">"continuous"</span>, </span>
<span>  exposure_trend <span class="op">=</span> <span class="st">"cos1"</span>, exposure_amp <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span>, </span>
<span>  average_outcome <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  outcome_trend <span class="op">=</span> <span class="st">"cos1"</span>,</span>
<span>  outcome_amp <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>  rr <span class="op">=</span> <span class="fl">1.0055</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model settings</span></span>
<span><span class="co">## Define the day of introduction (July 1st is day 1)</span></span>
<span><span class="va">str</span> <span class="op">&lt;-</span> <span class="st">"2000-07-01"</span></span>
<span><span class="co">## Define the end-day of life cycle (August 1st is the last day)</span></span>
<span><span class="va">endr</span> <span class="op">&lt;-</span> <span class="st">"2000-08-01"</span></span>
<span><span class="co">## Define the number of eggs to be introduced</span></span>
<span><span class="va">ie</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="co">## Define the number of model iterations</span></span>
<span><span class="va">it</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># The higher the number of simulations the better</span></span>
<span><span class="co">## Define the number of liters for the larval density-dependent mortality</span></span>
<span><span class="va">habitat_liters</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co">## Define latitude and longitude for the diapause process</span></span>
<span><span class="va">myLat</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="va">myLon</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="co">## Define the number of parallel processes (for sequential iterations set nc=1)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co">## convert float temperatures to integer</span></span>
<span><span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Date"</span> <span class="op">=</span> <span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">date</span>, <span class="st">"temp"</span> <span class="op">=</span> <span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/transpose.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">df_temp</span><span class="op">$</span><span class="va">temp</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,<span class="st">"%j"</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">endr</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,<span class="st">"%j"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-the-model">2.2 Run the model<a class="anchor" aria-label="anchor" href="#run-the-model"></a>
</h3>
<p>It is crucial to run the model the model specifying the argument
<code>compressed.output = FALSE</code>. This will return the number of
simulated individuals for each sub-compartments.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamAedes.m.html">dynamAedes.m</a></span><span class="op">(</span>species<span class="op">=</span><span class="st">"albopictus"</span>, </span>
<span> scale<span class="op">=</span><span class="st">"ws"</span>,  </span>
<span> jhwv<span class="op">=</span><span class="va">habitat_liters</span>,  </span>
<span> temps.matrix<span class="op">=</span><span class="va">w</span>,  </span>
<span> startd<span class="op">=</span><span class="va">str</span>, </span>
<span> endd<span class="op">=</span><span class="va">endr</span>,  </span>
<span> n.clusters<span class="op">=</span><span class="va">cl</span>, </span>
<span> iter<span class="op">=</span><span class="va">it</span>,  </span>
<span> intro.eggs<span class="op">=</span><span class="va">ie</span>,  </span>
<span> compressed.output<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span> lat<span class="op">=</span><span class="va">myLat</span>, </span>
<span> long<span class="op">=</span><span class="va">myLon</span>,</span>
<span> verbose<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span> seeding<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analyse-the-results">2.3 Analyse the results<a class="anchor" aria-label="anchor" href="#analyse-the-results"></a>
</h3>
<p>A first summary of simulations can be obtained with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simout</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#          Length           Class            Mode </span></span>
<span><span class="co">#               1 dynamAedesClass              S4</span></span></code></pre>
<p>The <em>simout</em> object is a S4 object where the outputs of the
model and related details are saved in different slot. For example, the
number of model iterations is saved in:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span><span class="op">@</span><span class="va">n_iterations</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 1</span></span></code></pre>
<p>The model output, i.e. the number of simulated individuals, is stored
in <code>simout@simulation</code>. For the <em>uncompressed</em> model,
<code>simout@simulation</code> is a list where the
<strong>first</strong> level stores the simulation of different
iteration, while the <strong>second</strong> corresponds to the
simulated days in the corresponding iteration. If we inspect the first
iteration, we observe that the model has computed
<code>length(simout[[1]])</code> days, since we have started the
simulation on the 1st of July and ended on the 1st of August.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">simout</span><span class="op">@</span><span class="va">simulation</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] 30</span></span></code></pre>
<p>The <strong>third</strong> level corresponds to an array reporting,
for a given iteration and a given day, the number of individuals
belonging to each compartment (rows) for each sub-compartment (the third
dimension of the array, noted as <em>sc1</em>-…-<em>scN</em> in the
print). As example, if we inspect the 1st and the 15th day within the
first iteration, we obtain a matrix having:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">simout</span><span class="op">@</span><span class="va">simulation</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># [1] "array"</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span><span class="op">@</span><span class="va">simulation</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co"># , , sc1</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile      355</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc2</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile        0</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc3</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile        0</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc4</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg           645</span></span>
<span><span class="co"># juvenile        0</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc5</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile        0</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc6</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile        0</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span><span class="op">@</span><span class="va">simulation</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">15</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co"># , , sc1</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile       82</span></span>
<span><span class="co"># adult           5</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc2</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg            48</span></span>
<span><span class="co"># juvenile       17</span></span>
<span><span class="co"># adult           2</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc3</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile        5</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc4</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg            80</span></span>
<span><span class="co"># juvenile        1</span></span>
<span><span class="co"># adult           1</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc5</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile        2</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># , , sc6</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#              [,1]</span></span>
<span><span class="co"># egg             0</span></span>
<span><span class="co"># juvenile        1</span></span>
<span><span class="co"># adult           0</span></span>
<span><span class="co"># diapause_egg    0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="derive-abundance-95-ci-for-a-specific-sub-compartment">2.4 Derive abundance 95% CI for a specific sub-compartment<a class="anchor" aria-label="anchor" href="#derive-abundance-95-ci-for-a-specific-sub-compartment"></a>
</h3>
<p>We can use the auxiliary functions of the package to analyse the
results. We now compute the interquantile range abundance for the
host-seeking sub-compartment of the simulated population using the
function <em>adci</em>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve the maximum number of simulated days</span></span>
<span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">simout</span><span class="op">)</span></span>
<span><span class="co"># Compute the inter-quartile of abundances along the iterations</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span><span class="op">)</span></span>
<span><span class="va">ed</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">dd</span></span>
<span><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adci.html">adci</a></span><span class="op">(</span><span class="va">simout</span>, eval_date<span class="op">=</span><span class="va">ed</span>, breaks<span class="op">=</span><span class="va">breaks</span>, </span>
<span>           stage<span class="op">=</span><span class="st">"Adults"</span>,</span>
<span>           sub_stage <span class="op">=</span> <span class="st">"Host-seeking"</span> <span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">hs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#   X25. X50. X75. day stage    sub_stage</span></span>
<span><span class="co"># 1    0    0    0   1 Adult Host-seeking</span></span>
<span><span class="co"># 2    0    0    0   2 Adult Host-seeking</span></span>
<span><span class="co"># 3    0    0    0   3 Adult Host-seeking</span></span>
<span><span class="co"># 4    0    0    0   4 Adult Host-seeking</span></span>
<span><span class="co"># 5    0    0    0   5 Adult Host-seeking</span></span>
<span><span class="co"># 6    0    0    0   6 Adult Host-seeking</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">hs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#    X25. X50. X75. day stage    sub_stage</span></span>
<span><span class="co"># 25    1    1    1  25 Adult Host-seeking</span></span>
<span><span class="co"># 26    1    1    1  26 Adult Host-seeking</span></span>
<span><span class="co"># 27    4    4    4  27 Adult Host-seeking</span></span>
<span><span class="co"># 28    1    1    1  28 Adult Host-seeking</span></span>
<span><span class="co"># 29    1    1    1  29 Adult Host-seeking</span></span>
<span><span class="co"># 30    1    1    1  30 Adult Host-seeking</span></span></code></pre>
<p>We can now simply plot it.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">hs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>, y<span class="op">=</span><span class="va">X50.</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stage</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stage</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Host-seeking Ae. albopictus Interquantile range abundance"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">X25.</span>, ymax<span class="op">=</span><span class="va">X75.</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">stage</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  col<span class="op">=</span><span class="st">"white"</span>, </span>
<span>  alpha<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>  outline.type<span class="op">=</span><span class="st">"full"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Interquantile range abundance"</span>, col<span class="op">=</span><span class="st">"Stage"</span>, fill<span class="op">=</span><span class="st">"Stage"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span>,  </span>
<span>  text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, </span>
<span>  strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_04_uncompModel_files/figure-html/unnamed-chunk-13-1.png" width="95%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="regional-scale-model">3. Regional scale model<a class="anchor" aria-label="anchor" href="#regional-scale-model"></a>
</h2>
<p>We can now repeat the exercise for a regional scale model.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/gstat/" class="external-link">gstat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># terra 1.7.65</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gridDim</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># 5000m/250 m = 20 columns and rows</span></span>
<span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">gridDim</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">gridDim</span><span class="op">)</span></span>
<span><span class="va">varioMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gstat/man/vgm.html" class="external-link">vgm</a></span><span class="op">(</span>psill<span class="op">=</span><span class="fl">0.5</span>, range<span class="op">=</span><span class="fl">100</span>, model<span class="op">=</span><span class="st">'Exp'</span><span class="op">)</span> <span class="co"># psill = partial sill = (sill-nugget)</span></span>
<span><span class="co"># Set up an additional variable from simple kriging</span></span>
<span><span class="va">zDummy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gstat/man/gstat.html" class="external-link">gstat</a></span><span class="op">(</span>formula<span class="op">=</span><span class="va">z</span><span class="op">~</span><span class="fl">1</span>, </span>
<span>                locations <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>, </span>
<span>                dummy<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                beta<span class="op">=</span><span class="fl">1</span>, </span>
<span>                model<span class="op">=</span><span class="va">varioMod</span>, </span>
<span>                nmax<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Generate a randomly autocorrelated predictor data field</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">xyz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">zDummy</span>, newdata<span class="op">=</span><span class="va">xy</span>, nsim<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">utm32N</span> <span class="op">&lt;-</span> <span class="st">"+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="va">gridDim</span>, ncol<span class="op">=</span><span class="va">gridDim</span>, crs<span class="op">=</span><span class="va">utm32N</span>, ext<span class="op">=</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">1220000</span>,<span class="fl">1225000</span>, <span class="fl">5700000</span>,<span class="fl">5705000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">xyz</span><span class="op">$</span><span class="va">sim1</span></span>
<span><span class="co"># plot(r, main="SAC landscape")</span></span>
<span></span>
<span><span class="co"># convert to a data.frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">xyz</span><span class="op">)</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.polygons.html" class="external-link">as.polygons</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, crs<span class="op">=</span><span class="va">utm32N</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store Parameters for autocorrelation</span></span>
<span><span class="va">autocorr_factor</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># "expand onto space" the temperature time series by multiplying it with the autocorrelated surface simulated above. </span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">d_t</span> <span class="op">&lt;-</span> <span class="va">sim_temp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">*</span><span class="va">autocorr_factor</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">d_t</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># format simulated temperature</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"d_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">ndays</span><span class="op">)</span></span>
<span><span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">mat</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df_temp</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># define a two-column matrix of coordinates to identify each cell in the lattice grid.</span></span>
<span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="va">df_temp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>We run now the regional model keeping the same settings defined for
the punctual scale model.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dynamAedes.m.html">dynamAedes.m</a></span><span class="op">(</span>species<span class="op">=</span><span class="st">"albopictus"</span>, </span>
<span>            scale<span class="op">=</span><span class="st">"rg"</span>,  </span>
<span>            jhwv<span class="op">=</span><span class="va">habitat_liters</span>,  </span>
<span>            temps.matrix<span class="op">=</span><span class="va">w</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span>,<span class="st">"%j"</span><span class="op">)</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">endr</span><span class="op">)</span>,<span class="st">"%j"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,</span>
<span>            coords.proj4<span class="op">=</span><span class="va">utm32N</span>,</span>
<span>            cells.coords<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/coerce.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span>,</span>
<span>            startd<span class="op">=</span><span class="va">str</span>,</span>
<span>            endd<span class="op">=</span><span class="va">endr</span>,</span>
<span>            n.clusters<span class="op">=</span><span class="va">cl</span>,</span>
<span>            iter<span class="op">=</span><span class="va">it</span>,</span>
<span>            intro.eggs<span class="op">=</span><span class="va">ie</span>,</span>
<span>            compressed.output<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>            seeding<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>            verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simout</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co"># Summary of dynamAedes simulations:</span></span>
<span><span class="co"># ----------------------------------</span></span>
<span><span class="co"># Species:                  Aedes albopictus </span></span>
<span><span class="co"># Scale:                    REGIONAL </span></span>
<span><span class="co"># Start Date:               2000-07-01 </span></span>
<span><span class="co"># End Date:                 2000-08-01 </span></span>
<span><span class="co"># Number of Iterations:     1 </span></span>
<span><span class="co"># Introduced Stage:         egg </span></span>
<span><span class="co"># Number Introduced:        1000 </span></span>
<span><span class="co"># Is Output Compressed?:    No </span></span>
<span><span class="co"># Water in the System:      1 L </span></span>
<span><span class="co"># Min days with population: 30 </span></span>
<span><span class="co"># Max days with population: 30</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect the raster</span></span>
<span><span class="va">hs.r</span><span class="op">$</span><span class="va">`Host-seeking_q_0.5`</span></span></code></pre></div>
<pre><code><span><span class="co"># class       : SpatRaster </span></span>
<span><span class="co"># dimensions  : 20, 20, 30  (nrow, ncol, nlyr)</span></span>
<span><span class="co"># resolution  : 250, 250  (x, y)</span></span>
<span><span class="co"># extent      : 1220000, 1225000, 5700000, 5705000  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># coord. ref. :  </span></span>
<span><span class="co"># source(s)   : memory</span></span>
<span><span class="co"># names       : day1, day2, day3, day4, day5, day6, ... </span></span>
<span><span class="co"># min values  :    0,    0,    0,    0,    0,    0, ... </span></span>
<span><span class="co"># max values  :    0,    0,    0,    0,    0,    0, ...</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the raster with the median host-seeking abundace</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hs.r</span><span class="op">$</span><span class="va">`Host-seeking_q_0.5`</span><span class="op">$</span><span class="va">day30</span><span class="op">)</span></span></code></pre></div>
<p><img src="dynamAedes_04_uncompModel_files/figure-html/unnamed-chunk-18-1.png" width="95%" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matteo Marcantonio, Daniele Da Re.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
